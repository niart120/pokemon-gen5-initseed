var f=(e=>(e[e.BwNew=0]="BwNew",e[e.BwContinue=1]="BwContinue",e[e.Bw2New=2]="Bw2New",e[e.Bw2Continue=3]="Bw2Continue",e))(f||{});const b=1e5,_=65535;function I(e){const n=[];(e.count<1||e.count>b)&&n.push(`count must be 1-${b}`),(e.conditions.tid<0||e.conditions.tid>_)&&n.push(`tid must be 0-${_}`),(e.conditions.sid<0||e.conditions.sid>_)&&n.push(`sid must be 0-${_}`);const s=(t,o)=>{t.forEach((i,a)=>{(i<0||i>32)&&n.push(`${o}[${a}] must be 0-32`)})};return s(e.parents.male,"parents.male"),s(e.parents.female,"parents.female"),e.filter&&e.filter.ivRanges.forEach((t,o)=>{(t.min<0||t.min>32)&&n.push(`filter.ivRanges[${o}].min must be 0-32`),(t.max<0||t.max>32)&&n.push(`filter.ivRanges[${o}].max must be 0-32`),t.min>t.max&&n.push(`filter.ivRanges[${o}].min must be <= max`)}),n}let d=null,m=null;async function E(){return d||m||(m=(async()=>{try{const e=await import("./wasm_pkg-a4vq4PfG.js");let n;if(typeof process<"u"&&!!process.versions?.node){const t=await import("./__vite-browser-external-9wXp6ZBx.js"),i=(await import("./__vite-browser-external-9wXp6ZBx.js")).join(process.cwd(),"src/wasm/wasm_pkg_bg.wasm");n={module_or_path:t.readFileSync(i)}}else n={module_or_path:new URL("/pokemon-gen5-initseed/assets/wasm_pkg_bg-pGc6cmQm.wasm",import.meta.url)};return await e.default(n),d={BWGenerationConfig:e.BWGenerationConfig,PokemonGenerator:e.PokemonGenerator,SeedEnumerator:e.SeedEnumerator,EncounterType:e.EncounterType,GameVersion:e.GameVersion,GameMode:e.GameMode,EggSeedEnumeratorJs:e.EggSeedEnumeratorJs,ParentsIVsJs:e.ParentsIVsJs,GenerationConditionsJs:e.GenerationConditionsJs,EverstonePlanJs:e.EverstonePlanJs,IndividualFilterJs:e.IndividualFilterJs,TrainerIds:e.TrainerIds,GenderRatio:e.GenderRatio,StatRange:e.StatRange,EggBootTimingSearchResult:e.EggBootTimingSearchResult,EggBootTimingSearchIterator:e.EggBootTimingSearchIterator,DSConfigJs:e.DSConfigJs,SegmentParamsJs:e.SegmentParamsJs,TimeRangeParamsJs:e.TimeRangeParamsJs,SearchRangeParamsJs:e.SearchRangeParamsJs,MtSeedBootTimingSearchIterator:e.MtSeedBootTimingSearchIterator,MtSeedBootTimingSearchResult:e.MtSeedBootTimingSearchResult,MtSeedBootTimingSearchResults:e.MtSeedBootTimingSearchResults,IdAdjustmentSearchIterator:e.IdAdjustmentSearchIterator,IdAdjustmentSearchResult:e.IdAdjustmentSearchResult,IdAdjustmentSearchResults:e.IdAdjustmentSearchResults,calculate_game_offset:e.calculate_game_offset,sha1_hash_batch:e.sha1_hash_batch,mt_seed_search_segment:e.mt_seed_search_segment},d}catch(e){throw console.error("Failed to load WebAssembly module:",e),d=null,m=null,e}})(),m)}function T(){if(!d)throw new Error("WebAssembly module not initialized. Call initWasm() first.");return d}function P(){return d!==null}const u={params:null,running:!1,stopRequested:!1};function J(e){switch(e){case f.BwNew:return 0;case f.BwContinue:return 2;case f.Bw2New:return 5;case f.Bw2Continue:return 7;default:return 2}}const w=self,l=e=>w.postMessage(e);l({type:"READY",version:"1"});w.onmessage=e=>{const n=e.data;(async()=>{try{switch(n.type){case"START_GENERATION":await B(n.params);break;case"STOP":u.stopRequested=!0;break;default:break}}catch(s){const t=s instanceof Error?s.message:String(s);l({type:"ERROR",message:t,category:"RUNTIME",fatal:!1})}})()};async function B(e){if(u.running)return;const n=I(e);if(n.length){l({type:"ERROR",message:n.join(", "),category:"VALIDATION",fatal:!1});return}u.params=e,u.stopRequested=!1,u.running=!0;try{await A();const s=V(e);F(s.results),l({type:"COMPLETE",payload:s.completion})}catch(s){const t=s instanceof Error?s.message:String(s);l({type:"ERROR",message:t,category:"WASM_INIT",fatal:!0})}finally{N()}}async function A(){P()||await E()}function W(e,n){return n.type==="none"?e.EverstonePlanJs.None:e.EverstonePlanJs.fixed(n.nature)}function x(e,n){const s=new e.IndividualFilterJs;if(!n)return s;for(let t=0;t<6;t++){const o=n.ivRanges[t];s.set_iv_range(t,o.min,o.max)}return n.nature!==void 0&&s.set_nature(n.nature),n.gender!==void 0&&s.set_gender(C(n.gender)),n.ability!==void 0&&s.set_ability(n.ability),n.shinyFilterMode!==void 0&&s.set_shiny_filter_mode(O(n.shinyFilterMode)),n.hiddenPowerType!==void 0&&s.set_hidden_power_type(n.hiddenPowerType),n.hiddenPowerPower!==void 0&&s.set_hidden_power_power(n.hiddenPowerPower),s}function C(e){switch(e){case"male":return 0;case"female":return 1;case"genderless":return 2;default:return 0}}function O(e){switch(e){case"all":return 0;case"shiny":return 1;case"star":return 2;case"square":return 3;case"non-shiny":return 4;default:return 0}}function M(e){switch(e){case 0:return"male";case 1:return"female";case 2:return"genderless";default:return"male"}}function k(e){return!e||e.type==="unknown"||e==="Unknown"?{type:"unknown"}:{type:"known",hpType:e.hp_type??e.hpType??0,power:e.power??0}}function D(e){if(!e)return null;try{const n=Number(e.advance),s=(()=>{const c=e.report_needle_direction??e.reportNeedleDirection;return typeof c=="number"&&Number.isFinite(c)?c:typeof c=="bigint"?Number(c):-1})(),t=e.egg,o=t.lcg_seed_hex??t.lcgSeedHex??"0x0",i=t.mt_seed_hex??t.mtSeedHex??"00000000",a={lcgSeedHex:o,mtSeedHex:i,ivs:[t.ivs[0],t.ivs[1],t.ivs[2],t.ivs[3],t.ivs[4],t.ivs[5]],nature:(typeof t.nature=="number",t.nature),gender:M(typeof t.gender=="number"?t.gender:0),ability:typeof t.ability=="number"?t.ability:0,shiny:typeof t.shiny=="number"?t.shiny:0,pid:t.pid,hiddenPower:k(t.hidden_power??t.hiddenPower)};return{advance:n,egg:a,isStable:e.is_stable??e.isStable??!1,reportNeedleDirection:s}}catch{return null}}function V(e){const s=T();if(!s.EggSeedEnumeratorJs)throw new Error("EggSeedEnumeratorJs not exposed in WASM");const t=[];let o=0,i=0,a="max-count";const c=performance.now(),g=new s.ParentsIVsJs;g.male=e.parents.male,g.female=e.parents.female;const r=new s.GenerationConditionsJs;r.has_nidoran_flag=e.conditions.hasNidoranFlag,r.set_everstone(W(s,e.conditions.everstone)),r.uses_ditto=e.conditions.usesDitto;const y=e.conditions.femaleParentAbility===2;r.allow_hidden_ability=y,r.female_parent_has_hidden=y,r.reroll_count=e.conditions.masudaMethod?3:0,r.set_trainer_ids(new s.TrainerIds(e.conditions.tid,e.conditions.sid)),r.set_gender_ratio(new s.GenderRatio(e.conditions.genderRatio.threshold,e.conditions.genderRatio.genderless));const p=x(s,e.filterDisabled?null:e.filter),S=new s.EggSeedEnumeratorJs(e.baseSeed,e.userOffset,e.count,r,g,p,e.considerNpcConsumption,J(e.gameMode));try{for(;;){if(u.stopRequested){a="stopped";break}const h=S.next_egg();if(!h){a="max-count";break}o++;const R=D(h);R&&(t.push(R),i++)}}catch(h){throw a="error",h}finally{S.free(),r.free?.(),g.free?.(),p&&p.free?.()}const v={reason:a,processedCount:o,filteredCount:i,elapsedMs:performance.now()-c};return{results:t,completion:v}}function F(e){l({type:"RESULTS",payload:{results:e}})}function N(){u.running=!1,u.params=null,u.stopRequested=!1}w.onclose=()=>{N()};
